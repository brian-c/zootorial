Giant rewrite in progress.

To document:

* Everything.
